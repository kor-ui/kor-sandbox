<kor-card flat label="Canvas">
  <!-- viewport -->
  <kor-switch slot="functions">
    <kor-switch-item
      *ngFor="let viewport of viewports"
      [icon]="viewport.icon"
      [active]="
        currentViewport.height == viewport.height &&
        currentViewport.width == viewport.width
      "
      (click)="
        currentViewport.height = viewport.height;
        currentViewport.width = viewport.width
      "
    ></kor-switch-item>
  </kor-switch>
  <!-- rotate -->
  <kor-divider
    slot="functions"
    orientation="vertical"
    spacing="s"
  ></kor-divider>
  <kor-icon
    slot="functions"
    button
    icon="screen_rotation"
    (click)="rotateDevice()"
  ></kor-icon>
  <kor-icon slot="functions" button icon="code" (click)="getCode()"></kor-icon>
  <!-- scale -->
  <kor-divider
    slot="functions"
    orientation="vertical"
    spacing="s"
  ></kor-divider>
  <div class="scale" slot="functions">
    <kor-icon
      button
      icon="remove"
      (click)="
        currentScale = currentScale > 0.2 ? currentScale - 0.05 : currentScale
      "
    ></kor-icon>
    <kor-text>{{ round(currentScale * 100) }}%</kor-text>
    <kor-icon
      button
      icon="add"
      (click)="
        currentScale = currentScale < 1.5 ? currentScale + 0.05 : currentScale
      "
    ></kor-icon>
  </div>
  <!-- canvas -->
  <div
    id="canvas"
    [style.height]="currentViewport?.height"
    [style.width]="currentViewport?.width"
    [style.zoom]="currentScale"
  >
    <kor-page
      flex-direction="column"
      (dragover)="drag.handleDragOver($event)"
      (dragleave)="drag.handleDragLeave($event)"
      (drop)="drag.handleDrop($event)"
      (click)="components.selectComponent($event.target)"
      (contextmenu)="handleContextMenu($event)"
    ></kor-page>
  </div>
</kor-card>

<!-- context menu -->
<kor-popover
  [visible]="showContextMenu"
  [style.left]="popoverCoords.x"
  [style.top]="popoverCoords.y"
>
  <kor-menu-item
    label="Delete"
    (click)="
      removeElement(components.selectedElement);
      $event.stopImmediatePropagation()
    "
  ></kor-menu-item>
  <kor-menu-item
    label="Duplicate"
    (click)="
      duplicateElement(components.selectedElement);
      $event.stopImmediatePropagation()
    "
  ></kor-menu-item>
</kor-popover>

<!-- code modal -->
<kor-modal
  height="800px"
  width="1200px"
  label="Code"
  [visible]="code"
  (visible-changed)="!$event.target.visible ? (code = undefined) : ''"
>
  <ngx-monaco-editor
    *ngIf="code"
    [options]="codeOptions"
    [(ngModel)]="code"
    (onInit)="formatCode($event)"
  ></ngx-monaco-editor>
</kor-modal>
